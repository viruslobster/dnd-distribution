#!/usr/bin/python3
from random import random
from functools import cache

PDF_NUM = [
    1, 4, 10, 21, 38, 62, 
    91, 122, 148, 167, 172, 
    160, 131, 94, 54, 21
]
PDF_DENOM = 6**4

@cache
def cdf(i):
    return sum(PDF_NUM[i:]) / PDF_DENOM

def factorial(x):
    if x == 0:
        return 1
    return x * factorial(x-1)

def n_choose_k(n, k):
    return factorial(n) / (factorial(k) * factorial(n-k))

def binomial(p, n, k):
    return n_choose_k(n, k) * p**k * (1 - p)**(n-k)

def chart(data, m, n):
    print("   ", end="")
    for i in range(n):
        print(f"{i+1:2}", end=" ")
    print()
    for i in range(m):
        print(f"{i+3:2}", end=" ")
        for j in range(n):
            print(f"{data[i][j]:02}", end=" ")
        print()

def distribution(K):
    data = []
    for i in range(16):
        data.append([None] * 7)

    for i in range(16):
        for j in range(7):
            n = j + 1
            p = 0
            for k in range(K, j+2):
                p += binomial(cdf(i), n, k)

            data[i][j]= min(int(100*p + 0.5), 99)

    chart(data, 16, 7)

for K in range(1, 8):
    print(f"K = {K}")
    distribution(K)
#$
K = 1
    1  2  3  4  5  6  7 
 3 99 99 99 99 99 99 99 
 4 99 99 99 99 99 99 99 
 5 99 99 99 99 99 99 99 
 6 99 99 99 99 99 99 99 
 7 97 99 99 99 99 99 99 
 8 94 99 99 99 99 99 99 
 9 90 99 99 99 99 99 99 
10 82 97 99 99 99 99 99 
11 73 93 98 99 99 99 99 
12 62 85 94 98 99 99 99 
13 49 74 87 93 96 98 99 
14 35 58 73 83 89 93 95 
15 23 41 55 65 73 79 84 
16 13 24 34 43 50 57 62 
17 06 11 16 21 26 30 34 
18 02 03 05 06 08 09 11 
K = 2
    1  2  3  4  5  6  7 
 3 00 99 99 99 99 99 99 
 4 00 99 99 99 99 99 99 
 5 00 99 99 99 99 99 99 
 6 00 98 99 99 99 99 99 
 7 00 95 99 99 99 99 99 
 8 00 89 99 99 99 99 99 
 9 00 80 97 99 99 99 99 
10 00 68 92 98 99 99 99 
11 00 53 82 94 98 99 99 
12 00 38 67 84 93 97 99 
13 00 24 48 67 80 88 93 
14 00 13 29 45 58 69 77 
15 00 05 14 23 33 42 51 
16 00 02 05 09 13 18 23 
17 00 00 01 02 03 04 06 
18 00 00 00 00 00 00 01 
K = 3
    1  2  3  4  5  6  7 
 3 00 00 99 99 99 99 99 
 4 00 00 99 99 99 99 99 
 5 00 00 99 99 99 99 99 
 6 00 00 97 99 99 99 99 
 7 00 00 92 99 99 99 99 
 8 00 00 84 98 99 99 99 
 9 00 00 72 94 99 99 99 
10 00 00 56 86 96 99 99 
11 00 00 39 71 88 95 98 
12 00 00 23 50 71 84 92 
13 00 00 12 29 48 63 75 
14 00 00 04 13 24 36 48 
15 00 00 01 04 08 14 21 
16 00 00 00 01 02 03 05 
17 00 00 00 00 00 00 01 
18 00 00 00 00 00 00 00 
K = 4
    1  2  3  4  5  6  7 
 3 00 00 00 99 99 99 99 
 4 00 00 00 99 99 99 99 
 5 00 00 00 98 99 99 99 
 6 00 00 00 95 99 99 99 
 7 00 00 00 89 99 99 99 
 8 00 00 00 79 97 99 99 
 9 00 00 00 64 91 98 99 
10 00 00 00 46 79 93 98 
11 00 00 00 29 59 80 91 
12 00 00 00 14 37 58 74 
13 00 00 00 06 17 32 47 
14 00 00 00 02 06 12 21 
15 00 00 00 00 01 03 05 
16 00 00 00 00 00 00 01 
17 00 00 00 00 00 00 00 
18 00 00 00 00 00 00 00 
K = 5
    1  2  3  4  5  6  7 
 3 00 00 00 00 99 99 99 
 4 00 00 00 00 99 99 99 
 5 00 00 00 00 98 99 99 
 6 00 00 00 00 94 99 99 
 7 00 00 00 00 87 99 99 
 8 00 00 00 00 75 96 99 
 9 00 00 00 00 57 88 97 
10 00 00 00 00 38 72 89 
11 00 00 00 00 21 49 72 
12 00 00 00 00 09 26 46 
13 00 00 00 00 03 10 21 
14 00 00 00 00 01 02 06 
15 00 00 00 00 00 00 01 
16 00 00 00 00 00 00 00 
17 00 00 00 00 00 00 00 
18 00 00 00 00 00 00 00 
K = 6
    1  2  3  4  5  6  7 
 3 00 00 00 00 00 99 99 
 4 00 00 00 00 00 99 99 
 5 00 00 00 00 00 98 99 
 6 00 00 00 00 00 93 99 
 7 00 00 00 00 00 84 99 
 8 00 00 00 00 00 70 94 
 9 00 00 00 00 00 51 84 
10 00 00 00 00 00 31 65 
11 00 00 00 00 00 15 40 
12 00 00 00 00 00 05 18 
13 00 00 00 00 00 01 05 
14 00 00 00 00 00 00 01 
15 00 00 00 00 00 00 00 
16 00 00 00 00 00 00 00 
17 00 00 00 00 00 00 00 
18 00 00 00 00 00 00 00 
K = 7
    1  2  3  4  5  6  7 
 3 00 00 00 00 00 00 99 
 4 00 00 00 00 00 00 99 
 5 00 00 00 00 00 00 97 
 6 00 00 00 00 00 00 92 
 7 00 00 00 00 00 00 82 
 8 00 00 00 00 00 00 66 
 9 00 00 00 00 00 00 46 
10 00 00 00 00 00 00 26 
11 00 00 00 00 00 00 11 
12 00 00 00 00 00 00 03 
13 00 00 00 00 00 00 01 
14 00 00 00 00 00 00 00 
15 00 00 00 00 00 00 00 
16 00 00 00 00 00 00 00 
17 00 00 00 00 00 00 00 
18 00 00 00 00 00 00 00 
#~
